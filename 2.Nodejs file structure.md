# File Structure
## Types of file structure
### 1. CommonJS Modules
- Default and most commonly used file structure in nodejs.
- We have to use require("`path of file`") in the main file which is going to be executed to execute that file also with it.
- With require you can just execute that another file but can't use that file's function into another file because by default files are protected and we have to explicitly export those function or variables to use them in another file (module.exports = {`name as you want to export`: `name of function want to export`} normally we take both same).
- Synchronous in nature.
- Not strict.
> Let's say if variable z is not defined and we wrtie `z = 5` then it do not give error that z is not defined, instead it makes a new var with value 5. This means not strict mode.

### 2. ES Modules
- ES module structure uses import and export statements just like ReactJS.
- To enable ES structure we have to make the `type = module` instead of commonjs in package.json.
- Asynchronous in nature.
- Strict.

> - In both the types we can make a folder a separate module.
> - In a folder with many files just make one more file with name index.js and import all the methods and variables you want to export from the module and just export from there.
> - We can directly import those exorted things from the folder name we dont have to explicitly import all those by there file names.

## How different files are loaded inside?
- Just like the function has its own private space and to access variables or function inside it you have to return them.
- Node binds that module into an IIFE (Immediately Invoked Function Expression) which invoked immediately when require is done.
- That's how it keeps functions and variables in it safe.

> **From where we are getting access to module.exports or require?**<br>
They are one of the parameters to function when node wraps it into IIFE.

## 5 Steps of require statement
1. <b><u>Resolving the module</u></b> : resolving the type of module (like .json, .js, etc) because to inherit information from different type there are different ways.
2. <b><u>Loading the module</u></b> : file content is loaded according to file type.
3. <b><u>Wraps inside IIFE</u></b> : wraps the content in IIFE to execute it.
4. <b><u>Evaluation</u></b> : executing the code and returning the module.exports.
5. <b><u>Caching</u></b> : Caching the work of the execution because it's possible that the same module is required in many places so nodejs just uses the cached data and do not execute it again and again.

> When node has to execute the code then also node wraps the file in IIFE and then pass it to V8 not directly pass the file.